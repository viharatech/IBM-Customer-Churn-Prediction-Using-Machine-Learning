{% extends 'base.html' %}
{% block content %}
{% set title = 'Customer Churn Prediction' %}

<div class="layout-container">

  <!-- Left: Sticky SIM Section -->
  <aside class="sim-sidebar">
    <h2>ðŸ“± SIM Provider</h2>
    <p>Select your telecom provider</p>

    <div class="sim-selection">
      <div class="sim-card" onclick="selectSim('Jio')">
        <img src="{{ url_for('static', filename='siva_image/jio.webp') }}" alt="Jio">
        <p>Jio</p>
      </div>
      <div class="sim-card" onclick="selectSim('Airtel')">
        <img src="{{ url_for('static', filename='siva_image/airtel.png') }}" alt="Airtel">
        <p>Airtel</p>
      </div>
      <div class="sim-card" onclick="selectSim('Vi')">
        <img src="{{ url_for('static', filename='siva_image/vi.webp') }}" alt="Vi">
        <p>Vi</p>
      </div>
      <div class="sim-card" onclick="selectSim('BSNL')">
        <img src="{{ url_for('static', filename='siva_image/bsnl.webp') }}" alt="BSNL">
        <p>BSNL</p>
      </div>
    </div>
  </aside>

  <!-- Right: Scrollable Form -->
  <main class="form-content">
    <h2>ðŸ§¾ Customer Churn Prediction Form</h2>
    <p class="subtitle">Fill customer details to predict churn likelihood.</p>

    <form action="/predict" method="post" class="form-grid">
      <input type="hidden" name="sim" id="selectedSim">

      <!-- Section 1 -->
      <h3 class="section-title">Customer Information</h3>

      <div class="form-group">
        <label>Gender</label>
        <select name="gender" required>
          <option value="">Select</option>
          <option>Male</option><option>Female</option>
        </select>
      </div>

      <div class="form-group">
        <label>Senior Citizen (0 or 1)</label>
        <input type="number" name="SeniorCitizen" min="0" max="1" required>
      </div>

      <div class="form-group">
        <label>Partner</label>
        <select name="Partner"><option>Yes</option><option>No</option></select>
      </div>

      <div class="form-group">
        <label>Dependents</label>
        <select name="Dependents"><option>Yes</option><option>No</option></select>
      </div>

      <!-- Section 2 -->
      <h3 class="section-title">Services Subscribed</h3>

      <div class="form-group">
        <label>Phone Service</label>
        <select name="PhoneService"><option>Yes</option><option>No</option></select>
      </div>

      <div class="form-group">
        <label>Multiple Lines</label>
        <select name="MultipleLines">
          <option>Yes</option><option>No</option><option>No phone service</option>
        </select>
      </div>

      <div class="form-group">
        <label>Internet Service</label>
        <select name="InternetService">
          <option>DSL</option><option>Fiber optic</option><option>No</option>
        </select>
      </div>

      <div class="form-group">
        <label>Online Security</label>
        <select name="OnlineSecurity">
          <option>Yes</option><option>No</option><option>No internet service</option>
        </select>
      </div>

      <div class="form-group">
        <label>Online Backup</label>
        <select name="OnlineBackup">
          <option>Yes</option><option>No</option><option>No internet service</option>
        </select>
      </div>

      <div class="form-group">
        <label>Device Protection</label>
        <select name="DeviceProtection">
          <option>Yes</option><option>No</option><option>No internet service</option>
        </select>
      </div>

      <div class="form-group">
        <label>Tech Support</label>
        <select name="TechSupport">
          <option>Yes</option><option>No</option><option>No internet service</option>
        </select>
      </div>

      <div class="form-group">
        <label>Streaming TV</label>
        <select name="StreamingTV">
          <option>Yes</option><option>No</option><option>No internet service</option>
        </select>
      </div>

      <div class="form-group">
        <label>Streaming Movies</label>
        <select name="StreamingMovies">
          <option>Yes</option><option>No</option><option>No internet service</option>
        </select>
      </div>

      <!-- Section 3 -->
      <h3 class="section-title">Billing & Contract</h3>

      <div class="form-group">
        <label>Contract</label>
        <select name="Contract">
          <option>Month-to-month</option><option>One year</option><option>Two year</option>
        </select>
      </div>

      <div class="form-group">
        <label>Paperless Billing</label>
        <select name="PaperlessBilling"><option>Yes</option><option>No</option></select>
      </div>

      <div class="form-group">
        <label>Payment Method</label>
        <select name="PaymentMethod">
          <option>Electronic check</option><option>Mailed check</option>
          <option>Bank transfer (automatic)</option><option>Credit card (automatic)</option>
        </select>
      </div>

      <!-- Section 4 -->
      <h3 class="section-title">Tenure & Charges</h3>

      <div class="form-group">
        <label>Tenure (Months Stayed)</label>
        <input type="number" name="tenure" min="1" placeholder="e.g., 36" required>
      </div>

      <div class="form-group">
        <label>Year Stayed</label>
        <input type="number" name="YearStayed" placeholder="e.g., 2020" required>
      </div>

      <div class="form-group">
        <label>Monthly Charges</label>
        <input type="number" step="0.01" name="MonthlyCharges_qt_outl" required>
      </div>

      <div class="form-group">
        <label>Total Charges</label>
        <input type="number" step="0.01" name="TotalCharges_qt_outl" required>
      </div>

      <button type="submit" class="btn">Predict Churn</button>
    </form>
  </main>
</div>

<script>
  function selectSim(simName) {
    document.getElementById('selectedSim').value = simName;
    document.querySelectorAll('.sim-card').forEach(c => c.classList.remove('active'));
    const selected = Array.from(document.querySelectorAll('.sim-card')).find(c => c.innerText.trim() === simName);
    if (selected) selected.classList.add('active');
  }
</script>

<style>
  /* Layout */
  .layout-container {
    display: flex;
    min-height: 90vh;
    background: #f8fafc;
  }

  .sim-sidebar {
    position: sticky;
    top: 2rem;
    align-self: flex-start;
    width: 240px;
    height: fit-content;
    background: #fff;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 6px 16px rgba(0,0,0,0.1);
    margin: 2rem;
  }

  .form-content {
    flex: 1;
    background: #fff;
    border-radius: 12px;
    padding: 2rem;
    margin: 2rem 2rem 2rem 0;
    box-shadow: 0 6px 16px rgba(0,0,0,0.1);
    overflow-y: auto;
    max-height: 85vh;
  }

  /* SIM Cards */
  .sim-selection {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1.2rem;
  }

  .sim-card {
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    text-align: center;
    padding: 1rem;
    cursor: pointer;
    transition: all 0.2s ease;
    background: #f9f9f9;
  }

  .sim-card img {
    width: 50px;
    height: 50px;
    object-fit: contain;
  }

  .sim-card.active {
    border-color: #007bff;
    background: #e8f2ff;
    box-shadow: 0 0 8px rgba(0,123,255,0.3);
  }

  .sim-card:hover {
    transform: scale(1.05);
  }

  /* Form */
  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1rem 1.5rem;
  }

  .section-title {
    grid-column: span 2;
    font-weight: bold;
    color: #007bff;
    margin-top: 1.5rem;
    border-bottom: 2px solid #007bff;
    padding-bottom: 4px;
  }

  .form-group label {
    font-weight: bold;
    font-size: 0.9rem;
  }

  .form-group input, .form-group select {
    width: 100%;
    padding: 0.4rem;
    border-radius: 6px;
    border: 1px solid #ccc;
    margin-top: 0.3rem;
  }

  .btn {
    grid-column: span 2;
    margin-top: 1.5rem;
    padding: 0.8rem;
    border: none;
    border-radius: 10px;
    background: linear-gradient(to right, #007bff, #00c6ff);
    color: #fff;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }

  .btn:hover {
    background: linear-gradient(to right, #0056b3, #009acd);
  }

  @media (max-width: 900px) {
    .layout-container {
      flex-direction: column;
    }

    .sim-sidebar {
      position: relative;
      top: 0;
      width: 100%;
      margin: 1rem 0;
    }

    .form-content {
      max-height: none;
      margin: 0 1rem 2rem 1rem;
    }
  }
</style>

{% endblock %}
